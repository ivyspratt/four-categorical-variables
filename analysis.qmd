---
title: "Four-Categorical-Variables"
author: "Ivy Spratt"
format: html
execute: 
  echo: false
---

Understanding the voter preference of different genders is essential for a candidate to design a campaign strategy. Using data from the National Election Studies survey of US citizens, we seek to understand the relationship between voter preference and sex in the 1992 Presidential election. However, since not everyone participates in the survey, the data might not be representative of the entire population.

```{r}
#| message: false
#| label: setup

library(tidyverse)
library(primer.data)
library(tidymodels)
library(gtsummary)
```

```{r}
nes_92 <- nes |> 
  filter(year == 1992) |> 
  select(sex, pres_vote) |> 
  drop_na() |> 
  mutate(pres_vote = as.factor(case_when(
    pres_vote == "Democrat" ~ "Clinton",
    pres_vote == "Republican" ~ "Bush",
    pres_vote == "Third Party" ~ "Perot",
  )))
```

$$ Y \sim \text{Mutinomial}(\rho_{bush}, \rho_{clinton}, \rho_{perot}) $$

$$ \begin{aligned}
\rho_{clinton} &=& \frac{e^{\beta_{0, clinton} + \beta_{1, clinton} male}}{1 + e^{\beta_{0, clinton} + \beta_{1, clinton} male}}\\
\rho_{perot} &=& \frac{e^{\beta_{0, perot} + \beta_{1, perot} male}}{1 + e^{\beta_{0, perot} + \beta_{1, perot} male}}\\
\rho_{bush}  &=& 1 - \rho_{clinton} - \rho_{perot}
\end{aligned} $$


```{r}
#| label: model
#| cache: true

fit_nes <- multinom_reg(engine = "nnet") |>
  fit(pres_vote ~ sex, data = nes_92)
```
